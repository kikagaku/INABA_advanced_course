<!DOCTYPE html>
<html class="writer-html5" lang="ja" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Python 速習とテーブルデータの基本操作 &mdash; 応用講座コース  ドキュメント</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/translations.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" />
    <link rel="next" title="演習問題" href="01_01_01_question.html" />
    <link rel="prev" title="データの理解" href="01_01_00_data.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> 応用講座コース
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="00_title.html">– Python 速習とテーブルデータの操作 –</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_00_colab.html">Google Colaboratory 実習</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_01_00_data.html">データの理解</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Python 速習とテーブルデータの基本操作</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#GoogleDrive-のマウント">GoogleDrive のマウント</a></li>
<li class="toctree-l2"><a class="reference internal" href="#パスの設定">パスの設定</a></li>
<li class="toctree-l2"><a class="reference internal" href="#必要なモジュールのインポート">必要なモジュールのインポート</a></li>
<li class="toctree-l2"><a class="reference internal" href="#基本的なテーブルデータ操作-(Pandas)">基本的なテーブルデータ操作 (Pandas)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#データの読み込み">データの読み込み</a></li>
<li class="toctree-l3"><a class="reference internal" href="#データの切り分け">データの切り分け</a></li>
<li class="toctree-l3"><a class="reference internal" href="#データの並び替え">データの並び替え</a></li>
<li class="toctree-l3"><a class="reference internal" href="#列の削除・追加">列の削除・追加</a></li>
<li class="toctree-l3"><a class="reference internal" href="#データの絞り込み">データの絞り込み</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#基本的なデータの可視化-(Matplotlib,-Seaborn)">基本的なデータの可視化 (Matplotlib, Seaborn)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#【補足】データの種類">【補足】データの種類</a></li>
<li class="toctree-l3"><a class="reference internal" href="#分布の把握：棒グラフ">分布の把握：棒グラフ</a></li>
<li class="toctree-l3"><a class="reference internal" href="#分布の把握：ヒストグラム">分布の把握：ヒストグラム</a></li>
<li class="toctree-l3"><a class="reference internal" href="#傾向の把握：折れ線グラフ">傾向の把握：折れ線グラフ</a></li>
<li class="toctree-l3"><a class="reference internal" href="#相関関係の把握：散布図、ヒートマップ">相関関係の把握：散布図、ヒートマップ</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#散布図">散布図</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ヒートマップ">ヒートマップ</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#【補足】Matplotlib-の描画方法について">【補足】Matplotlib の描画方法について</a></li>
<li class="toctree-l2"><a class="reference internal" href="#データの集計操作">データの集計操作</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#グループ化">グループ化</a></li>
<li class="toctree-l3"><a class="reference internal" href="#クロス集計">クロス集計</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ピボットテーブル">ピボットテーブル</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#欠損値対応">欠損値対応</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#欠損値除去">欠損値除去</a></li>
<li class="toctree-l3"><a class="reference internal" href="#欠損値の補完">欠損値の補完</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#質的変数への対応">質的変数への対応</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Label-Encoding">Label Encoding</a></li>
<li class="toctree-l3"><a class="reference internal" href="#One-Hot-Encoding">One-Hot Encoding</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#【補足】Python-補足資料">【補足】Python 補足資料</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Python">Python</a></li>
<li class="toctree-l3"><a class="reference internal" href="#NumPy">NumPy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Pandas">Pandas</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Matplotlib-/-seaborn">Matplotlib / seaborn</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="01_01_01_question.html">演習問題</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_04_exercise_classification.html">問題設定：Bank Marketing</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_05_bankmarketing.html">実装例</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_00title.html">– データの前処理と機械学習モデルの構築 –</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_01_create_feature.html">モデル構築のための特徴量作成</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_02_K-Fold.html">モデルの精度を保証する実装</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_03_XAI.html">説明可能な AI (XAI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_00title.html">– 時系列解析 –</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_01_timeseries_basic.html">時系列データの取り扱い方</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_02_timeseries_analysis.html">自己回帰型モデル</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_00title.html">– 異常検知 –</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_01.html">異常検知とは</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_02_outlier.html">外れ値検知入門</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_03_other_outlier.html">【補足】 外れ値検知 - その他の手法</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_04_ml_base.html">機械学習を用いた異常検知入門</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_05_other_ml_base.html">【補足】機械学習を用いた異常検知 - その他の手法</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_13_nearest_neighbers.html">変化点検知入門</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_17_generation.html">【補足】 生成モデルによる異常部位検知</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_18_auto_encoder.html">【補足】 異常部位検知 - AutoEncoder</a></li>
<li class="toctree-l1"><a class="reference internal" href="99_11ability-test2.html">【補足】 実力テスト - 機械学習セクション</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">応用講座コース</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Python 速習とテーブルデータの基本操作</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/src/01_01_00_python_basic.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Python-速習とテーブルデータの基本操作">
<h1>Python 速習とテーブルデータの基本操作<a class="headerlink" href="#Python-速習とテーブルデータの基本操作" title="この見出しへのパーマリンク"></a></h1>
<p>▼ 本章で使用するデータ</p>
<ul class="simple">
<li><p><a class="reference external" href="https://drive.google.com/file/d/1pu4Y-QvHA1TNQRN_6tTyZ7Fp7bgBR6Ft/view?usp=sharing">covid_data.csv</a></p></li>
</ul>
<p>▼ 本章の構成</p>
<ul class="simple">
<li><p>GoogleDrive のマウント</p></li>
<li><p>パスの設定</p></li>
<li><p>必要なモジュールのインポート</p></li>
<li><p>基本的なテーブルデータ操作 (Pandas)</p></li>
<li><p>基本的なデータの可視化 (Matplotlib, Seaborn)</p></li>
<li><p>データの集計操作</p></li>
<li><p>欠損値対応</p></li>
<li><p>質的変数への対応</p></li>
</ul>
<hr class="docutils" />
<section id="GoogleDrive-のマウント">
<h2>GoogleDrive のマウント<a class="headerlink" href="#GoogleDrive-のマウント" title="この見出しへのパーマリンク"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># # コメントアウトを外して実行してください
# from google.colab import drive
# drive.mount(&#39;/content/drive/&#39;)
</pre></div>
</div>
</div>
</section>
<section id="パスの設定">
<h2>パスの設定<a class="headerlink" href="#パスの設定" title="この見出しへのパーマリンク"></a></h2>
<p>講義資料と同じコードで実装が進められるようにパスの設定を行います。data フォルダまでのパスを <code class="docutils literal notranslate"><span class="pre">data_path</span></code> という変数に格納しておきます。講義資料と同じ階層でデータを格納している場合は以下のコードをそのまま実行してください。</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># パスの設定
data_path = &#39;&#39;
</pre></div>
</div>
</div>
</section>
<section id="必要なモジュールのインポート">
<h2>必要なモジュールのインポート<a class="headerlink" href="#必要なモジュールのインポート" title="この見出しへのパーマリンク"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

plt.rcParams[&#39;figure.figsize&#39;] = 10, 5 # 描画サイズの設定

# 警告非表示
import warnings
warnings.filterwarnings(&#39;ignore&#39;)
</pre></div>
</div>
</div>
</section>
<section id="基本的なテーブルデータ操作-(Pandas)">
<h2>基本的なテーブルデータ操作 (Pandas)<a class="headerlink" href="#基本的なテーブルデータ操作-(Pandas)" title="この見出しへのパーマリンク"></a></h2>
<p>まずは Pandas を使用したデータ操作の基本を確認しましょう。</p>
<ul class="simple">
<li><p>データの読み込み</p></li>
<li><p>データの切り分け</p></li>
<li><p>データの並び替え</p></li>
<li><p>列の削除・追加</p></li>
<li><p>データの絞り込み</p></li>
</ul>
<section id="データの読み込み">
<h3>データの読み込み<a class="headerlink" href="#データの読み込み" title="この見出しへのパーマリンク"></a></h3>
<p>まずはデータセットの読み込みから行いましょう。<a class="reference external" href="drive/MyDrive/quick/data/covid_data.csv">covid_data.csv</a> を使用します。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># データの読み込み
df = pd.read_csv(f&#39;{data_path}/covid_data.csv&#39;, index_col=&#39;date&#39;, parse_dates=True) # date 列をインデックス列に指定
df.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>iso_code</th>
      <th>continent</th>
      <th>location</th>
      <th>new_cases</th>
      <th>new_deaths</th>
      <th>total_cases_per_million</th>
      <th>total_deaths_per_million</th>
      <th>total_tests_per_thousand</th>
      <th>population</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-10-11</th>
      <td>ABW</td>
      <td>North America</td>
      <td>Aruba</td>
      <td>19.0</td>
      <td>1.0</td>
      <td>145948.972</td>
      <td>1585.895</td>
      <td>NaN</td>
      <td>107195.0</td>
    </tr>
    <tr>
      <th>2021-10-12</th>
      <td>ABW</td>
      <td>North America</td>
      <td>Aruba</td>
      <td>18.0</td>
      <td>0.0</td>
      <td>146116.890</td>
      <td>1585.895</td>
      <td>NaN</td>
      <td>107195.0</td>
    </tr>
    <tr>
      <th>2021-10-13</th>
      <td>ABW</td>
      <td>North America</td>
      <td>Aruba</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>146116.890</td>
      <td>1585.895</td>
      <td>NaN</td>
      <td>107195.0</td>
    </tr>
    <tr>
      <th>2021-10-14</th>
      <td>ABW</td>
      <td>North America</td>
      <td>Aruba</td>
      <td>29.0</td>
      <td>0.0</td>
      <td>146387.425</td>
      <td>1585.895</td>
      <td>NaN</td>
      <td>107195.0</td>
    </tr>
    <tr>
      <th>2021-10-15</th>
      <td>ABW</td>
      <td>North America</td>
      <td>Aruba</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>146480.713</td>
      <td>1585.895</td>
      <td>NaN</td>
      <td>107195.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Pandas で読み込んだものはデータフレームと呼ばれます。データの読み込みが完了しましたら、まず <code class="docutils literal notranslate"><span class="pre">shape</span></code> でデータのサンプル数や変数の数を確認する癖をつけておきましょう。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>df.shape
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(23728, 9)
</pre></div></div>
</div>
<p>今回のデータセットはサンプル数が 23728 個、変数は 9 個あることがわかりました。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># データの確認（先頭3件）
df.head(3)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>iso_code</th>
      <th>continent</th>
      <th>location</th>
      <th>new_cases</th>
      <th>new_deaths</th>
      <th>total_cases_per_million</th>
      <th>total_deaths_per_million</th>
      <th>total_tests_per_thousand</th>
      <th>population</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-10-11</th>
      <td>ABW</td>
      <td>North America</td>
      <td>Aruba</td>
      <td>19.0</td>
      <td>1.0</td>
      <td>145948.972</td>
      <td>1585.895</td>
      <td>NaN</td>
      <td>107195.0</td>
    </tr>
    <tr>
      <th>2021-10-12</th>
      <td>ABW</td>
      <td>North America</td>
      <td>Aruba</td>
      <td>18.0</td>
      <td>0.0</td>
      <td>146116.890</td>
      <td>1585.895</td>
      <td>NaN</td>
      <td>107195.0</td>
    </tr>
    <tr>
      <th>2021-10-13</th>
      <td>ABW</td>
      <td>North America</td>
      <td>Aruba</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>146116.890</td>
      <td>1585.895</td>
      <td>NaN</td>
      <td>107195.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>各カラムの詳細は以下を参照してください。</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 48%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>列名</p></th>
<th class="head"><p>説明</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>date</p></td>
<td><p>データの取得日</p></td>
</tr>
<tr class="row-odd"><td><p>iso_code</p></td>
<td><p>国名コード</p></td>
</tr>
<tr class="row-even"><td><p>continent</p></td>
<td><p>大陸名</p></td>
</tr>
<tr class="row-odd"><td><p>location</p></td>
<td><p>国名</p></td>
</tr>
<tr class="row-even"><td><p>new_cases</p></td>
<td><p>新規感染者数</p></td>
</tr>
<tr class="row-odd"><td><p>new_deaths</p></td>
<td><p>新規死者数</p></td>
</tr>
<tr class="row-even"><td><p>total_cases_per_million</p></td>
<td><p>百万人あたりの合計感染者数</p></td>
</tr>
<tr class="row-odd"><td><p>total_deaths_per_million</p></td>
<td><p>百万人あたりの合計死者数</p></td>
</tr>
<tr class="row-even"><td><p>total_tests_per_thousand</p></td>
<td><p>千人あたりの合計検査数</p></td>
</tr>
<tr class="row-odd"><td><p>population</p></td>
<td><p>人口</p></td>
</tr>
</tbody>
</table>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># データの確認（末尾3件）
df.tail(3)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>iso_code</th>
      <th>continent</th>
      <th>location</th>
      <th>new_cases</th>
      <th>new_deaths</th>
      <th>total_cases_per_million</th>
      <th>total_deaths_per_million</th>
      <th>total_tests_per_thousand</th>
      <th>population</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2022-01-16</th>
      <td>ZWE</td>
      <td>Africa</td>
      <td>Zimbabwe</td>
      <td>441.0</td>
      <td>9.0</td>
      <td>14979.820</td>
      <td>347.664</td>
      <td>119.071</td>
      <td>15092171.0</td>
    </tr>
    <tr>
      <th>2022-01-17</th>
      <td>ZWE</td>
      <td>Africa</td>
      <td>Zimbabwe</td>
      <td>382.0</td>
      <td>11.0</td>
      <td>15005.131</td>
      <td>348.393</td>
      <td>NaN</td>
      <td>15092171.0</td>
    </tr>
    <tr>
      <th>2022-01-18</th>
      <td>ZWE</td>
      <td>Africa</td>
      <td>Zimbabwe</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15005.131</td>
      <td>348.393</td>
      <td>NaN</td>
      <td>15092171.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># 基本情報の確認
df.info()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
DatetimeIndex: 23728 entries, 2021-10-11 to 2022-01-18
Data columns (total 9 columns):
 #   Column                    Non-Null Count  Dtype
---  ------                    --------------  -----
 0   iso_code                  23728 non-null  object
 1   continent                 22428 non-null  object
 2   location                  23728 non-null  object
 3   new_cases                 22727 non-null  float64
 4   new_deaths                21399 non-null  float64
 5   total_cases_per_million   22682 non-null  float64
 6   total_deaths_per_million  21323 non-null  float64
 7   total_tests_per_thousand  8344 non-null   float64
 8   population                23528 non-null  float64
dtypes: float64(6), object(3)
memory usage: 1.8+ MB
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># 要約統計量の確認
df.describe()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>new_cases</th>
      <th>new_deaths</th>
      <th>total_cases_per_million</th>
      <th>total_deaths_per_million</th>
      <th>total_tests_per_thousand</th>
      <th>population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>2.272700e+04</td>
      <td>21399.000000</td>
      <td>22682.000000</td>
      <td>21323.000000</td>
      <td>8344.000000</td>
      <td>2.352800e+04</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.825464e+04</td>
      <td>138.156176</td>
      <td>59135.597814</td>
      <td>951.562042</td>
      <td>1756.101110</td>
      <td>1.350157e+08</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.228185e+05</td>
      <td>656.999407</td>
      <td>60769.572341</td>
      <td>1010.394458</td>
      <td>2895.849384</td>
      <td>6.735454e+08</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-1.149000e+03</td>
      <td>-165.000000</td>
      <td>8.602000</td>
      <td>3.101000</td>
      <td>9.094000</td>
      <td>4.700000e+01</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000000e+00</td>
      <td>0.000000</td>
      <td>4733.656250</td>
      <td>117.978000</td>
      <td>248.142250</td>
      <td>6.583910e+05</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.430000e+02</td>
      <td>2.000000</td>
      <td>41875.254000</td>
      <td>630.972000</td>
      <td>875.894500</td>
      <td>6.896655e+06</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.741500e+03</td>
      <td>19.000000</td>
      <td>94784.577000</td>
      <td>1589.620500</td>
      <td>1888.801750</td>
      <td>3.173213e+07</td>
    </tr>
    <tr>
      <th>max</th>
      <td>3.701647e+06</td>
      <td>10069.000000</td>
      <td>386379.502000</td>
      <td>6104.573000</td>
      <td>23364.957000</td>
      <td>7.874966e+09</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="データの切り分け">
<h3>データの切り分け<a class="headerlink" href="#データの切り分け" title="この見出しへのパーマリンク"></a></h3>
<p>統計モデルや機械学習モデルを作成する際は、データを説明変数と目的変数に分割することが多いです。今回は説明変数 <code class="docutils literal notranslate"><span class="pre">x</span></code> と目的変数 <code class="docutils literal notranslate"><span class="pre">t</span></code> として 1 つのデータフレームから分割してみます。<code class="docutils literal notranslate"><span class="pre">total_deaths_per_million</span></code> を目的変数として分割してみましょう。</p>
<p>方法は様々ありますが、今回は <code class="docutils literal notranslate"><span class="pre">drop()</span></code> メソッドを使用します。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># 説明変数の分割
x = df.drop([&#39;total_deaths_per_million&#39;], axis=1)
x.head(3)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>iso_code</th>
      <th>continent</th>
      <th>location</th>
      <th>new_cases</th>
      <th>new_deaths</th>
      <th>total_cases_per_million</th>
      <th>total_tests_per_thousand</th>
      <th>population</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-10-11</th>
      <td>ABW</td>
      <td>North America</td>
      <td>Aruba</td>
      <td>19.0</td>
      <td>1.0</td>
      <td>145948.972</td>
      <td>NaN</td>
      <td>107195.0</td>
    </tr>
    <tr>
      <th>2021-10-12</th>
      <td>ABW</td>
      <td>North America</td>
      <td>Aruba</td>
      <td>18.0</td>
      <td>0.0</td>
      <td>146116.890</td>
      <td>NaN</td>
      <td>107195.0</td>
    </tr>
    <tr>
      <th>2021-10-13</th>
      <td>ABW</td>
      <td>North America</td>
      <td>Aruba</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>146116.890</td>
      <td>NaN</td>
      <td>107195.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># 目的変数の分割
t = df[&#39;total_deaths_per_million&#39;]
t.head(3)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
date
2021-10-11    1585.895
2021-10-12    1585.895
2021-10-13    1585.895
Name: total_deaths_per_million, dtype: float64
</pre></div></div>
</div>
</section>
<section id="データの並び替え">
<h3>データの並び替え<a class="headerlink" href="#データの並び替え" title="この見出しへのパーマリンク"></a></h3>
<p>データの中身を確認するときに降順や昇順で並び替えて、確認したい場合もあります。<code class="docutils literal notranslate"><span class="pre">sort_values('ソートする列名')</span></code> メソッドで並び替えは可能です。</p>
<p>それでは <code class="docutils literal notranslate"><span class="pre">total_deaths_per_million</span></code> に関して、並び順を変更してみましょう。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>df.sort_values(&#39;total_deaths_per_million&#39;, ascending=False) # ascending=Falseにすることで降順で表示
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>iso_code</th>
      <th>continent</th>
      <th>location</th>
      <th>new_cases</th>
      <th>new_deaths</th>
      <th>total_cases_per_million</th>
      <th>total_deaths_per_million</th>
      <th>total_tests_per_thousand</th>
      <th>population</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2022-01-18</th>
      <td>PER</td>
      <td>South America</td>
      <td>Peru</td>
      <td>62098.0</td>
      <td>181.0</td>
      <td>79984.136</td>
      <td>6104.573</td>
      <td>NaN</td>
      <td>33359415.0</td>
    </tr>
    <tr>
      <th>2022-01-17</th>
      <td>PER</td>
      <td>South America</td>
      <td>Peru</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>78122.653</td>
      <td>6099.148</td>
      <td>NaN</td>
      <td>33359415.0</td>
    </tr>
    <tr>
      <th>2022-01-16</th>
      <td>PER</td>
      <td>South America</td>
      <td>Peru</td>
      <td>43592.0</td>
      <td>88.0</td>
      <td>78122.653</td>
      <td>6099.148</td>
      <td>NaN</td>
      <td>33359415.0</td>
    </tr>
    <tr>
      <th>2022-01-15</th>
      <td>PER</td>
      <td>South America</td>
      <td>Peru</td>
      <td>49745.0</td>
      <td>74.0</td>
      <td>76815.915</td>
      <td>6096.510</td>
      <td>NaN</td>
      <td>33359415.0</td>
    </tr>
    <tr>
      <th>2022-01-14</th>
      <td>PER</td>
      <td>South America</td>
      <td>Peru</td>
      <td>39080.0</td>
      <td>47.0</td>
      <td>75324.732</td>
      <td>6094.292</td>
      <td>NaN</td>
      <td>33359415.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2022-01-14</th>
      <td>WSM</td>
      <td>Oceania</td>
      <td>Samoa</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>14.989</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>200144.0</td>
    </tr>
    <tr>
      <th>2022-01-15</th>
      <td>WSM</td>
      <td>Oceania</td>
      <td>Samoa</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>14.989</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>200144.0</td>
    </tr>
    <tr>
      <th>2022-01-16</th>
      <td>WSM</td>
      <td>Oceania</td>
      <td>Samoa</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>14.989</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>200144.0</td>
    </tr>
    <tr>
      <th>2022-01-17</th>
      <td>WSM</td>
      <td>Oceania</td>
      <td>Samoa</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>14.989</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>200144.0</td>
    </tr>
    <tr>
      <th>2022-01-18</th>
      <td>WSM</td>
      <td>Oceania</td>
      <td>Samoa</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>14.989</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>200144.0</td>
    </tr>
  </tbody>
</table>
<p>23728 rows × 9 columns</p>
</div></div>
</div>
</section>
<section id="列の削除・追加">
<h3>列の削除・追加<a class="headerlink" href="#列の削除・追加" title="この見出しへのパーマリンク"></a></h3>
<p>列を削除する方法は <code class="docutils literal notranslate"><span class="pre">.drop(labels=列名)</span></code> で実行できます。列を削除する際には <code class="docutils literal notranslate"><span class="pre">axis=1</span></code> と指定する必要がある点に注意しましょう。（デフォルトでは <code class="docutils literal notranslate"><span class="pre">axis=0</span></code>(行方向)です。）</p>
<p><code class="docutils literal notranslate"><span class="pre">total_deaths_per_million'</span></code> の列を削除し、その後戻してみましょう。</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># total_deaths_per_million 列を変数に格納しておく（後で戻すため）
total_deaths_per_million = df[&#39;total_deaths_per_million&#39;]

# total_deaths_per_million 列を削除
df = df.drop(labels=&#39;total_deaths_per_million&#39;, axis=1)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>df.head(3)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>iso_code</th>
      <th>continent</th>
      <th>location</th>
      <th>new_cases</th>
      <th>new_deaths</th>
      <th>total_cases_per_million</th>
      <th>total_tests_per_thousand</th>
      <th>population</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-10-11</th>
      <td>ABW</td>
      <td>North America</td>
      <td>Aruba</td>
      <td>19.0</td>
      <td>1.0</td>
      <td>145948.972</td>
      <td>NaN</td>
      <td>107195.0</td>
    </tr>
    <tr>
      <th>2021-10-12</th>
      <td>ABW</td>
      <td>North America</td>
      <td>Aruba</td>
      <td>18.0</td>
      <td>0.0</td>
      <td>146116.890</td>
      <td>NaN</td>
      <td>107195.0</td>
    </tr>
    <tr>
      <th>2021-10-13</th>
      <td>ABW</td>
      <td>North America</td>
      <td>Aruba</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>146116.890</td>
      <td>NaN</td>
      <td>107195.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">total_deaths_per_million</span></code> 列が削除されていることが確認できました。それでは削除した列を改めて追加しましょう。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># total_deaths_per_million 列を追加
df[&#39;total_deaths_per_million&#39;] = total_deaths_per_million # 新しい列名を指定して代入
df.head(3)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>iso_code</th>
      <th>continent</th>
      <th>location</th>
      <th>new_cases</th>
      <th>new_deaths</th>
      <th>total_cases_per_million</th>
      <th>total_tests_per_thousand</th>
      <th>population</th>
      <th>total_deaths_per_million</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-10-11</th>
      <td>ABW</td>
      <td>North America</td>
      <td>Aruba</td>
      <td>19.0</td>
      <td>1.0</td>
      <td>145948.972</td>
      <td>NaN</td>
      <td>107195.0</td>
      <td>1585.895</td>
    </tr>
    <tr>
      <th>2021-10-12</th>
      <td>ABW</td>
      <td>North America</td>
      <td>Aruba</td>
      <td>18.0</td>
      <td>0.0</td>
      <td>146116.890</td>
      <td>NaN</td>
      <td>107195.0</td>
      <td>1585.895</td>
    </tr>
    <tr>
      <th>2021-10-13</th>
      <td>ABW</td>
      <td>North America</td>
      <td>Aruba</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>146116.890</td>
      <td>NaN</td>
      <td>107195.0</td>
      <td>1585.895</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>列の位置は変化しましたが、再度 <code class="docutils literal notranslate"><span class="pre">total_deaths_per_million</span></code> を追加できました。</p>
</section>
<section id="データの絞り込み">
<h3>データの絞り込み<a class="headerlink" href="#データの絞り込み" title="この見出しへのパーマリンク"></a></h3>
<p>特定の条件に合致するデータに絞り込む方法も確認しておきます。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># location が Japan　のデータに絞り込み
df[df[&#39;location&#39;]==&#39;Japan&#39;].head(3)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>iso_code</th>
      <th>continent</th>
      <th>location</th>
      <th>new_cases</th>
      <th>new_deaths</th>
      <th>total_cases_per_million</th>
      <th>total_tests_per_thousand</th>
      <th>population</th>
      <th>total_deaths_per_million</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-10-11</th>
      <td>JPN</td>
      <td>Asia</td>
      <td>Japan</td>
      <td>369.0</td>
      <td>20.0</td>
      <td>13605.023</td>
      <td>193.135</td>
      <td>126050796.0</td>
      <td>142.458</td>
    </tr>
    <tr>
      <th>2021-10-12</th>
      <td>JPN</td>
      <td>Asia</td>
      <td>Japan</td>
      <td>607.0</td>
      <td>29.0</td>
      <td>13609.839</td>
      <td>193.596</td>
      <td>126050796.0</td>
      <td>142.689</td>
    </tr>
    <tr>
      <th>2021-10-13</th>
      <td>JPN</td>
      <td>Asia</td>
      <td>Japan</td>
      <td>731.0</td>
      <td>33.0</td>
      <td>13615.638</td>
      <td>194.055</td>
      <td>126050796.0</td>
      <td>142.950</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>複数の条件で絞り込むこともできます。OR 条件の場合は <code class="docutils literal notranslate"><span class="pre">|</span></code>、AND 条件の場合は <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> で条件を接続します。</p>
<p>各条件を<code class="docutils literal notranslate"><span class="pre">()</span></code>で括る必要がある点に注意しましょう。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># location が Japan　かつ total_deaths_per_million が 100 以上
df[(df[&#39;location&#39;]==&#39;Japan&#39;) &amp; (df[&#39;total_deaths_per_million&#39;] &gt;= 100)].head(3)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>iso_code</th>
      <th>continent</th>
      <th>location</th>
      <th>new_cases</th>
      <th>new_deaths</th>
      <th>total_cases_per_million</th>
      <th>total_tests_per_thousand</th>
      <th>population</th>
      <th>total_deaths_per_million</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-10-11</th>
      <td>JPN</td>
      <td>Asia</td>
      <td>Japan</td>
      <td>369.0</td>
      <td>20.0</td>
      <td>13605.023</td>
      <td>193.135</td>
      <td>126050796.0</td>
      <td>142.458</td>
    </tr>
    <tr>
      <th>2021-10-12</th>
      <td>JPN</td>
      <td>Asia</td>
      <td>Japan</td>
      <td>607.0</td>
      <td>29.0</td>
      <td>13609.839</td>
      <td>193.596</td>
      <td>126050796.0</td>
      <td>142.689</td>
    </tr>
    <tr>
      <th>2021-10-13</th>
      <td>JPN</td>
      <td>Asia</td>
      <td>Japan</td>
      <td>731.0</td>
      <td>33.0</td>
      <td>13615.638</td>
      <td>194.055</td>
      <td>126050796.0</td>
      <td>142.950</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># location が Japan　または　total_deaths_per_million が 100 以上
df[(df[&#39;location&#39;]==&#39;Japan&#39;) | (df[&#39;total_deaths_per_million&#39;] &gt;= 100)].head(3)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>iso_code</th>
      <th>continent</th>
      <th>location</th>
      <th>new_cases</th>
      <th>new_deaths</th>
      <th>total_cases_per_million</th>
      <th>total_tests_per_thousand</th>
      <th>population</th>
      <th>total_deaths_per_million</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-10-11</th>
      <td>ABW</td>
      <td>North America</td>
      <td>Aruba</td>
      <td>19.0</td>
      <td>1.0</td>
      <td>145948.972</td>
      <td>NaN</td>
      <td>107195.0</td>
      <td>1585.895</td>
    </tr>
    <tr>
      <th>2021-10-12</th>
      <td>ABW</td>
      <td>North America</td>
      <td>Aruba</td>
      <td>18.0</td>
      <td>0.0</td>
      <td>146116.890</td>
      <td>NaN</td>
      <td>107195.0</td>
      <td>1585.895</td>
    </tr>
    <tr>
      <th>2021-10-13</th>
      <td>ABW</td>
      <td>North America</td>
      <td>Aruba</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>146116.890</td>
      <td>NaN</td>
      <td>107195.0</td>
      <td>1585.895</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
</section>
<section id="基本的なデータの可視化-(Matplotlib,-Seaborn)">
<h2>基本的なデータの可視化 (Matplotlib, Seaborn)<a class="headerlink" href="#基本的なデータの可視化-(Matplotlib,-Seaborn)" title="この見出しへのパーマリンク"></a></h2>
<p>データの性質を知るためには、データを様々な図で可視化することが有効です。可視化の方法はたくさんありますが、ここでは代表的なものをピックアップして確認します。</p>
<ul class="simple">
<li><p>分布の把握</p></li>
<li><p>傾向の把握</p></li>
<li><p>相関の把握</p></li>
</ul>
<section id="【補足】データの種類">
<h3>【補足】データの種類<a class="headerlink" href="#【補足】データの種類" title="この見出しへのパーマリンク"></a></h3>
<p>データは大きく 2 種類に分けられます。質的変数と量的変数です。質的変数はカテゴリカルな値で、離散値を取ります。量的変数は連続値になります。具体例は以下です。</p>
<ul class="simple">
<li><p>質的変数：満足度（5 段階評価）、性別（男女）、ランキング（10 段階）</p></li>
<li><p>量的変数：身長、売上、気温</p></li>
</ul>
<p>データの種類により可視化の方法も変えることが効果的ですので、データの種類についても押さえておきましょう。</p>
</section>
<section id="分布の把握：棒グラフ">
<h3>分布の把握：棒グラフ<a class="headerlink" href="#分布の把握：棒グラフ" title="この見出しへのパーマリンク"></a></h3>
<p>質的変数において、各カテゴリ毎の分布を把握する際には<strong>棒グラフ</strong>で可視化します。今回のデータでは大陸 (<code class="docutils literal notranslate"><span class="pre">continent</span></code>) は質的変数にあたるため、こちらを可視化してみましょう。</p>
<p>Matplotlib では <code class="docutils literal notranslate"><span class="pre">bar()</span></code> 関数で棒グラフを可視化できます。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x = df[&#39;continent&#39;].value_counts().index  # 横軸の値
height = df[&#39;continent&#39;].value_counts().values  # 　縦軸の値

print(x, height)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Index([&#39;Africa&#39;, &#39;Europe&#39;, &#39;Asia&#39;, &#39;North America&#39;, &#39;Oceania&#39;,
       &#39;South America&#39;],
      dtype=&#39;object&#39;) [5500 5100 5000 3500 2028 1300]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># 棒グラフの描画
plt.bar(x, height);
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/src_01_01_00_python_basic_39_0.png" src="../_images/src_01_01_00_python_basic_39_0.png" />
</div>
</div>
<p>Seaborn というライブラリを使用して棒グラフを可視化することも可能です。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># seaborn を使う場合
sns.countplot(df[&#39;continent&#39;]);
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/src_01_01_00_python_basic_41_0.png" src="../_images/src_01_01_00_python_basic_41_0.png" />
</div>
</div>
<p>このデータセットには、Africa のデータが最も多いことがわかりました。</p>
</section>
<section id="分布の把握：ヒストグラム">
<h3>分布の把握：ヒストグラム<a class="headerlink" href="#分布の把握：ヒストグラム" title="この見出しへのパーマリンク"></a></h3>
<p>量的変数の分布を把握する際には、ヒストグラムを使用します。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># ヒストグラムの描画
plt.hist(df[&#39;total_deaths_per_million&#39;]);
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/src_01_01_00_python_basic_44_0.png" src="../_images/src_01_01_00_python_basic_44_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># seaborn を使う場合
sns.distplot(df[&#39;total_deaths_per_million&#39;], kde=False, bins=10);
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/src_01_01_00_python_basic_45_0.png" src="../_images/src_01_01_00_python_basic_45_0.png" />
</div>
</div>
<p>データの分布を把握することで、外れ値の有無や、欠損値補完の方法を考察する助けになります。</p>
</section>
<section id="傾向の把握：折れ線グラフ">
<h3>傾向の把握：折れ線グラフ<a class="headerlink" href="#傾向の把握：折れ線グラフ" title="この見出しへのパーマリンク"></a></h3>
<p>量的変数の時間軸に沿った変化傾向を見る際には、折れ線グラフで可視化を行います。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># 日本のデータのみを取得
japan = df[df[&#39;location&#39;] == &#39;Japan&#39;]
# 日本の total_deaths_per_million を取得
total_deaths = japan[&#39;total_deaths_per_million&#39;]
plt.plot(total_deaths);
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/src_01_01_00_python_basic_48_0.png" src="../_images/src_01_01_00_python_basic_48_0.png" />
</div>
</div>
</section>
<section id="相関関係の把握：散布図、ヒートマップ">
<h3>相関関係の把握：散布図、ヒートマップ<a class="headerlink" href="#相関関係の把握：散布図、ヒートマップ" title="この見出しへのパーマリンク"></a></h3>
<p>今までの可視化は 1 変数に絞った可視化でしたが、相関関係は 2 変数に着目します。2 変数間の相関関係を把握する際には、散布図やヒートマップを用います。</p>
<section id="散布図">
<h4>散布図<a class="headerlink" href="#散布図" title="この見出しへのパーマリンク"></a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># 散布図の描画
plt.scatter(df[&#39;new_cases&#39;], df[&#39;new_deaths&#39;]);
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/src_01_01_00_python_basic_51_0.png" src="../_images/src_01_01_00_python_basic_51_0.png" />
</div>
</div>
</section>
<section id="ヒートマップ">
<h4>ヒートマップ<a class="headerlink" href="#ヒートマップ" title="この見出しへのパーマリンク"></a></h4>
<p>変数が多い場合にはすべての変数同士の散布図を確認するのは大変です。その場合には、グラフではなく相関係数を色付きで表示するヒートマップによる可視化が有効です。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># 相関係数の算出
df_corr = df.corr()
df_corr
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>new_cases</th>
      <th>new_deaths</th>
      <th>total_cases_per_million</th>
      <th>total_tests_per_thousand</th>
      <th>population</th>
      <th>total_deaths_per_million</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>new_cases</th>
      <td>1.000000</td>
      <td>0.708971</td>
      <td>0.072576</td>
      <td>0.047405</td>
      <td>0.526319</td>
      <td>0.072821</td>
    </tr>
    <tr>
      <th>new_deaths</th>
      <td>0.708971</td>
      <td>1.000000</td>
      <td>0.024643</td>
      <td>-0.025522</td>
      <td>0.785291</td>
      <td>0.077031</td>
    </tr>
    <tr>
      <th>total_cases_per_million</th>
      <td>0.072576</td>
      <td>0.024643</td>
      <td>1.000000</td>
      <td>0.441086</td>
      <td>-0.080106</td>
      <td>0.681603</td>
    </tr>
    <tr>
      <th>total_tests_per_thousand</th>
      <td>0.047405</td>
      <td>-0.025522</td>
      <td>0.441086</td>
      <td>1.000000</td>
      <td>-0.110850</td>
      <td>0.025992</td>
    </tr>
    <tr>
      <th>population</th>
      <td>0.526319</td>
      <td>0.785291</td>
      <td>-0.080106</td>
      <td>-0.110850</td>
      <td>1.000000</td>
      <td>-0.055998</td>
    </tr>
    <tr>
      <th>total_deaths_per_million</th>
      <td>0.072821</td>
      <td>0.077031</td>
      <td>0.681603</td>
      <td>0.025992</td>
      <td>-0.055998</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># 相関係数をヒートマップで描画
plt.figure(figsize=(10, 8)) # 出力サイズの調整
sns.heatmap(df_corr, annot=True, vmin=-1, vmax=1, center=0);
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/src_01_01_00_python_basic_55_0.png" src="../_images/src_01_01_00_python_basic_55_0.png" />
</div>
</div>
</section>
</section>
</section>
<section id="【補足】Matplotlib-の描画方法について">
<h2>【補足】Matplotlib の描画方法について<a class="headerlink" href="#【補足】Matplotlib-の描画方法について" title="この見出しへのパーマリンク"></a></h2>
<p>Matploblib を使用した可視化の際、グラフのラベルや凡例、罫線の表示等、様々な点を工夫することが可能です。簡単なサンプルデータを作成して表示の変更方法を確認します。</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># グラフ内で日本語を使用する場合はこちらを使用
# !pip install -q japanize_matplotlib
import japanize_matplotlib
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># サンプルデータの表示
plt.plot([&#39;月&#39;, &#39;火&#39;, &#39;水&#39;, &#39;木&#39;, &#39;金&#39;, &#39;土&#39;, &#39;日&#39;],
         [7, 10, 12, 8, 6, 7, 10])
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x17582f3a0&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/src_01_01_00_python_basic_59_1.png" src="../_images/src_01_01_00_python_basic_59_1.png" />
</div>
</div>
<p>上記のグラフに各軸の説明とタイトル、罫線を追加します。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># サンプルデータの表示
plt.plot([&#39;月&#39;, &#39;火&#39;, &#39;水&#39;, &#39;木&#39;, &#39;金&#39;, &#39;土&#39;, &#39;日&#39;],
         [7, 10, 12, 8, 6, 7, 10])
plt.xlabel(&#39;曜日&#39;)
plt.ylabel(&#39;気温&#39;)
plt.title(&#39;東京 2月 1週目&#39;)
plt.grid()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/src_01_01_00_python_basic_61_0.png" src="../_images/src_01_01_00_python_basic_61_0.png" />
</div>
</div>
<p>それでは、データを 1 組追加して、凡例を表示させてみましょう。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># サンプルデータの表示
plt.plot([&#39;月&#39;, &#39;火&#39;, &#39;水&#39;, &#39;木&#39;, &#39;金&#39;, &#39;土&#39;, &#39;日&#39;],
         [7, 10, 12, 8, 6, 7, 10],
         label=&#39;最低気温&#39;)
plt.plot([&#39;月&#39;, &#39;火&#39;, &#39;水&#39;, &#39;木&#39;, &#39;金&#39;, &#39;土&#39;, &#39;日&#39;],
         [10, 12, 13, 11, 9, 11, 11],
         label=&#39;最高気温&#39;)
plt.xlabel(&#39;曜日&#39;)
plt.ylabel(&#39;気温&#39;)
plt.title(&#39;東京 2月 1週目&#39;)
plt.grid()
plt.legend() # 凡例の表示
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x175901f10&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/src_01_01_00_python_basic_63_1.png" src="../_images/src_01_01_00_python_basic_63_1.png" />
</div>
</div>
</section>
<section id="データの集計操作">
<h2>データの集計操作<a class="headerlink" href="#データの集計操作" title="この見出しへのパーマリンク"></a></h2>
<p>ここまでデータフレームの扱い方からデータの可視化方法まで扱いました。最後にデータを集計する方法について扱います。代表的な以下の項目に関して説明します。</p>
<ul class="simple">
<li><p>グループ化（groupby ・ resample）</p></li>
<li><p>クロス集計（crosstab）</p></li>
<li><p>ピボットテーブル</p></li>
</ul>
<p>集計に関しては基本的に質的変数でグルーピングして行います。（量的変数は無限通りのパターンが考えられるため集計には向きません。）</p>
<section id="グループ化">
<h3>グループ化<a class="headerlink" href="#グループ化" title="この見出しへのパーマリンク"></a></h3>
<p>任意の質的変数でグルーピングを行って統計量を把握する際には、<code class="docutils literal notranslate"><span class="pre">groupby()</span></code> メソッドを使用します。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># continent でグループ化
df.groupby(&#39;continent&#39;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x175934610&gt;
</pre></div></div>
</div>
<p>上記だけでは値を確認できません。確認したい統計量のメソッドを後ろにつけることで値を確認できます。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># continent　でグループ化して平均値を見る
df.groupby(&#39;continent&#39;).mean()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>new_cases</th>
      <th>new_deaths</th>
      <th>total_cases_per_million</th>
      <th>total_tests_per_thousand</th>
      <th>population</th>
      <th>total_deaths_per_million</th>
    </tr>
    <tr>
      <th>continent</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Africa</th>
      <td>363.973699</td>
      <td>3.611163</td>
      <td>16350.201593</td>
      <td>167.803765</td>
      <td>2.493988e+07</td>
      <td>260.528149</td>
    </tr>
    <tr>
      <th>Asia</th>
      <td>2932.382850</td>
      <td>28.652970</td>
      <td>48085.107028</td>
      <td>1281.589444</td>
      <td>9.495135e+07</td>
      <td>520.116360</td>
    </tr>
    <tr>
      <th>Europe</th>
      <td>9450.383357</td>
      <td>69.857143</td>
      <td>124094.145660</td>
      <td>3347.277208</td>
      <td>1.471928e+07</td>
      <td>1840.323213</td>
    </tr>
    <tr>
      <th>North America</th>
      <td>7612.596812</td>
      <td>52.877405</td>
      <td>66414.786436</td>
      <td>744.719363</td>
      <td>1.693814e+07</td>
      <td>994.046432</td>
    </tr>
    <tr>
      <th>Oceania</th>
      <td>1179.503479</td>
      <td>2.446809</td>
      <td>20572.603993</td>
      <td>1406.974667</td>
      <td>2.130071e+06</td>
      <td>590.838477</td>
    </tr>
    <tr>
      <th>South America</th>
      <td>4402.862202</td>
      <td>32.458333</td>
      <td>70411.589907</td>
      <td>565.468200</td>
      <td>3.338105e+07</td>
      <td>2237.222273</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>複数の統計量を確認したい場合は <code class="docutils literal notranslate"><span class="pre">agg()</span></code> メソッドを使用すると便利です。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># continent　でグループ化して平均値、中央値、最小値、最大値を見る
df.groupby(&#39;continent&#39;).agg([&#39;mean&#39;, &#39;median&#39;, &#39;min&#39;, &#39;max&#39;])
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="4" halign="left">new_cases</th>
      <th colspan="4" halign="left">new_deaths</th>
      <th colspan="2" halign="left">total_cases_per_million</th>
      <th>...</th>
      <th colspan="2" halign="left">total_tests_per_thousand</th>
      <th colspan="4" halign="left">population</th>
      <th colspan="4" halign="left">total_deaths_per_million</th>
    </tr>
    <tr>
      <th></th>
      <th>mean</th>
      <th>median</th>
      <th>min</th>
      <th>max</th>
      <th>mean</th>
      <th>median</th>
      <th>min</th>
      <th>max</th>
      <th>mean</th>
      <th>median</th>
      <th>...</th>
      <th>min</th>
      <th>max</th>
      <th>mean</th>
      <th>median</th>
      <th>min</th>
      <th>max</th>
      <th>mean</th>
      <th>median</th>
      <th>min</th>
      <th>max</th>
    </tr>
    <tr>
      <th>continent</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Africa</th>
      <td>363.973699</td>
      <td>15.0</td>
      <td>0.0</td>
      <td>37875.0</td>
      <td>3.611163</td>
      <td>0.0</td>
      <td>-6.0</td>
      <td>181.0</td>
      <td>16350.201593</td>
      <td>3763.0785</td>
      <td>...</td>
      <td>10.217</td>
      <td>845.513</td>
      <td>2.493988e+07</td>
      <td>13276517.0</td>
      <td>6095.0</td>
      <td>2.114007e+08</td>
      <td>260.528149</td>
      <td>74.1720</td>
      <td>3.101</td>
      <td>2162.995</td>
    </tr>
    <tr>
      <th>Asia</th>
      <td>2932.382850</td>
      <td>310.0</td>
      <td>-1149.0</td>
      <td>533035.0</td>
      <td>28.652970</td>
      <td>3.0</td>
      <td>-2.0</td>
      <td>3007.0</td>
      <td>48085.107028</td>
      <td>27038.6670</td>
      <td>...</td>
      <td>9.094</td>
      <td>11831.801</td>
      <td>9.495135e+07</td>
      <td>16946446.0</td>
      <td>441532.0</td>
      <td>1.444216e+09</td>
      <td>520.116360</td>
      <td>337.5365</td>
      <td>3.210</td>
      <td>3646.439</td>
    </tr>
    <tr>
      <th>Europe</th>
      <td>9450.383357</td>
      <td>1610.0</td>
      <td>-1096.0</td>
      <td>372766.0</td>
      <td>69.857143</td>
      <td>12.0</td>
      <td>-39.0</td>
      <td>1222.0</td>
      <td>124094.145660</td>
      <td>111159.0380</td>
      <td>...</td>
      <td>305.457</td>
      <td>23364.957</td>
      <td>1.471928e+07</td>
      <td>4982904.0</td>
      <td>812.0</td>
      <td>1.459120e+08</td>
      <td>1840.323213</td>
      <td>1773.0560</td>
      <td>40.772</td>
      <td>4688.940</td>
    </tr>
    <tr>
      <th>North America</th>
      <td>7612.596812</td>
      <td>22.0</td>
      <td>-48.0</td>
      <td>1364418.0</td>
      <td>52.877405</td>
      <td>0.0</td>
      <td>-165.0</td>
      <td>3894.0</td>
      <td>66414.786436</td>
      <td>57094.3530</td>
      <td>...</td>
      <td>13.278</td>
      <td>2245.321</td>
      <td>1.693814e+07</td>
      <td>184401.0</td>
      <td>4981.0</td>
      <td>3.329151e+08</td>
      <td>994.046432</td>
      <td>869.7300</td>
      <td>17.585</td>
      <td>2565.084</td>
    </tr>
    <tr>
      <th>Oceania</th>
      <td>1179.503479</td>
      <td>0.0</td>
      <td>-9.0</td>
      <td>175271.0</td>
      <td>2.446809</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>81.0</td>
      <td>20572.603993</td>
      <td>440.1890</td>
      <td>...</td>
      <td>703.274</td>
      <td>2251.792</td>
      <td>2.130071e+06</td>
      <td>116255.0</td>
      <td>47.0</td>
      <td>2.578822e+07</td>
      <td>590.838477</td>
      <td>370.6080</td>
      <td>3.180</td>
      <td>2251.057</td>
    </tr>
    <tr>
      <th>South America</th>
      <td>4402.862202</td>
      <td>753.0</td>
      <td>-1.0</td>
      <td>140342.0</td>
      <td>32.458333</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>621.0</td>
      <td>70411.589907</td>
      <td>67154.1750</td>
      <td>...</td>
      <td>99.080</td>
      <td>1472.536</td>
      <td>3.338105e+07</td>
      <td>17888474.0</td>
      <td>3528.0</td>
      <td>2.139934e+08</td>
      <td>2237.222273</td>
      <td>1984.7290</td>
      <td>161.436</td>
      <td>6104.573</td>
    </tr>
  </tbody>
</table>
<p>6 rows × 24 columns</p>
</div></div>
</div>
<p>時系列データ特有の集計方法についても確認しておきましょう。時系列データでは <code class="docutils literal notranslate"><span class="pre">resample()</span></code> メソッドを使用することで、特定の時間単位でデータを集計することができます。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># 四半期末ごとで集計
df.resample(&#39;Q&#39;).sum()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>new_cases</th>
      <th>new_deaths</th>
      <th>total_cases_per_million</th>
      <th>total_tests_per_thousand</th>
      <th>population</th>
      <th>total_deaths_per_million</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-06-30</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>2.451474e+08</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>2021-09-30</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>3.688571e+08</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>2021-12-31</th>
      <td>216949188.0</td>
      <td>2463424.0</td>
      <td>1.043525e+09</td>
      <td>1.205958e+07</td>
      <td>2.604350e+12</td>
      <td>1.636154e+07</td>
    </tr>
    <tr>
      <th>2022-03-31</th>
      <td>197923978.0</td>
      <td>492980.0</td>
      <td>2.977885e+08</td>
      <td>2.593326e+06</td>
      <td>5.716855e+11</td>
      <td>3.928617e+06</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>絞り込む期間を指定する際は <code class="docutils literal notranslate"><span class="pre">Q</span></code> といった頻度コードで指定します。頻度コードについては以下を参照してください。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">D</span></code>: 毎日</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">B</span></code>: 毎営業日（月曜 - 金曜）</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">W</span></code>: 毎週（日曜始まり）</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">M</span></code>: 月末ごと</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SM</span></code>: 15日と月末ごと</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Q</span></code>: 四半期末ごと</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">A</span></code> または <code class="docutils literal notranslate"><span class="pre">Y</span></code>: 年末ごと</p></li>
</ul>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">M</span></code>, <code class="docutils literal notranslate"><span class="pre">Q</span></code>, <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">Y</span></code> については期間の末日が対象。</div>
<div class="line">先頭に <code class="docutils literal notranslate"><span class="pre">B</span></code> を付けると営業日（月曜 - 金曜）。</div>
<div class="line">末尾に <code class="docutils literal notranslate"><span class="pre">S</span></code> をつけると開始日となります。</div>
</div>
</section>
<section id="クロス集計">
<h3>クロス集計<a class="headerlink" href="#クロス集計" title="この見出しへのパーマリンク"></a></h3>
<p>2 つの質的変数同士で掛け合わせ、各変数毎のサンプル数を集計するにはクロス集計を行います。クロス集計は、<code class="docutils literal notranslate"><span class="pre">crosstab()</span></code> メソッドで実行できます。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># クロス集計
pd.crosstab(df[&#39;continent&#39;], df[&#39;location&#39;])
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>location</th>
      <th>Afghanistan</th>
      <th>Albania</th>
      <th>Algeria</th>
      <th>Andorra</th>
      <th>Angola</th>
      <th>Anguilla</th>
      <th>Antigua and Barbuda</th>
      <th>Argentina</th>
      <th>Armenia</th>
      <th>Aruba</th>
      <th>...</th>
      <th>Uruguay</th>
      <th>Uzbekistan</th>
      <th>Vanuatu</th>
      <th>Vatican</th>
      <th>Venezuela</th>
      <th>Vietnam</th>
      <th>Wallis and Futuna</th>
      <th>Yemen</th>
      <th>Zambia</th>
      <th>Zimbabwe</th>
    </tr>
    <tr>
      <th>continent</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Africa</th>
      <td>0</td>
      <td>0</td>
      <td>100</td>
      <td>0</td>
      <td>100</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>100</td>
      <td>100</td>
    </tr>
    <tr>
      <th>Asia</th>
      <td>100</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>100</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>100</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>100</td>
      <td>0</td>
      <td>100</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Europe</th>
      <td>0</td>
      <td>100</td>
      <td>0</td>
      <td>100</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>100</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>North America</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>100</td>
      <td>100</td>
      <td>0</td>
      <td>0</td>
      <td>100</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Oceania</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>100</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>100</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>South America</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>100</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>100</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>100</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>6 rows × 225 columns</p>
</div></div>
</div>
</section>
<section id="ピボットテーブル">
<h3>ピボットテーブル<a class="headerlink" href="#ピボットテーブル" title="この見出しへのパーマリンク"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">pivot_table()</span></code> メソッドを使用することで、2つの質的変数をかけ合わせた上で、任意の数値について様々な集計を行えます。</p>
<p><code class="docutils literal notranslate"><span class="pre">aggfunc</span></code> という引数で 平均値や合計等、集計方法を指定することができます。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># ピボットテーブルで集計し、平均値と中央値を算出
pd.pivot_table(df, values=&#39;total_deaths_per_million&#39;, # 集計する要素を指定
               index=&#39;continent&#39;, # index 側の要素を指定
               columns=&#39;location&#39;, # column 側の要素を指定
               aggfunc=[&#39;mean&#39;, &#39;median&#39;]) # 統計量を指定
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="10" halign="left">mean</th>
      <th>...</th>
      <th colspan="10" halign="left">median</th>
    </tr>
    <tr>
      <th>location</th>
      <th>Afghanistan</th>
      <th>Albania</th>
      <th>Algeria</th>
      <th>Andorra</th>
      <th>Angola</th>
      <th>Anguilla</th>
      <th>Antigua and Barbuda</th>
      <th>Argentina</th>
      <th>Armenia</th>
      <th>Aruba</th>
      <th>...</th>
      <th>United States</th>
      <th>Uruguay</th>
      <th>Uzbekistan</th>
      <th>Vanuatu</th>
      <th>Venezuela</th>
      <th>Vietnam</th>
      <th>Wallis and Futuna</th>
      <th>Yemen</th>
      <th>Zambia</th>
      <th>Zimbabwe</th>
    </tr>
    <tr>
      <th>continent</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Africa</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>136.49732</td>
      <td>NaN</td>
      <td>51.23944</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>193.809</td>
      <td>311.8505</td>
    </tr>
    <tr>
      <th>Asia</th>
      <td>183.53919</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2433.9921</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>41.269</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>256.227</td>
      <td>NaN</td>
      <td>63.9375</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Europe</th>
      <td>NaN</td>
      <td>1066.2688</td>
      <td>NaN</td>
      <td>1728.54657</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>North America</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>222.14891</td>
      <td>1124.70632</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1638.41602</td>
      <td>...</td>
      <td>2345.367</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Oceania</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.18</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>630.972</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>South America</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2556.58713</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>1759.0335</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>179.203</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>6 rows × 404 columns</p>
</div></div>
</div>
<p>算出できない部分に関しては上記のように NaN (Not a Number) と表示されます。</p>
</section>
</section>
<section id="欠損値対応">
<h2>欠損値対応<a class="headerlink" href="#欠損値対応" title="この見出しへのパーマリンク"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">NaN</span></code> と表記されている値を欠損値（または欠測値）と呼び、こちらがあると統計モデルや機械学習モデルではうまく分析できないことが多いです。欠損値があるデータに対する前処理の方法について押さえておきましょう。</p>
<p>まずは欠損値がどこにあるのかを確認しましょう。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># 欠損値の確認
df.isnull()[:5]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>iso_code</th>
      <th>continent</th>
      <th>location</th>
      <th>new_cases</th>
      <th>new_deaths</th>
      <th>total_cases_per_million</th>
      <th>total_tests_per_thousand</th>
      <th>population</th>
      <th>total_deaths_per_million</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-10-11</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2021-10-12</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2021-10-13</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2021-10-14</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2021-10-15</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>欠損値であるデータに関しては True と表示されています。欠損値の個数を確認するには <code class="docutils literal notranslate"><span class="pre">isnull().sum()</span></code> メソッドを使用します。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># 欠損値の数を確認
df.isnull().sum()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
iso_code                        0
continent                    1300
location                        0
new_cases                    1001
new_deaths                   2329
total_cases_per_million      1046
total_tests_per_thousand    15384
population                    200
total_deaths_per_million     2405
dtype: int64
</pre></div></div>
</div>
<p>欠損値を視覚的に把握したい場合はヒートマップを使用する方法もあります。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>sns.heatmap(df.isnull(), cbar=False);  # カラーバーは非表示に設定
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/src_01_01_00_python_basic_84_0.png" src="../_images/src_01_01_00_python_basic_84_0.png" />
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">total_tests_per_thousand</span></code> 列に多くの欠損値が存在することがわかりました。</p>
<p>欠損値に対するアプローチは大きく分けて 2 つになります。</p>
<ol class="arabic simple">
<li><p>欠損値の除去</p></li>
<li><p>欠損値の補完</p></li>
</ol>
<section id="欠損値除去">
<h3>欠損値除去<a class="headerlink" href="#欠損値除去" title="この見出しへのパーマリンク"></a></h3>
<p>欠損値除去とは、名前から推測できるように欠損値を取り除く方法です。欠損値の取り除き方は大きく 2 つです。</p>
<ul class="simple">
<li><p>行方向に除去する（サンプル数が減少）</p></li>
<li><p>列方向に除去する（カラム数が減少）</p></li>
</ul>
<p>表形式のテーブルデータであれば上記どちらも対応可能ですが、時系列データの場合は行方向に除去してしまうと時間が欠けてしまうためあまりよいアプローチではありません。</p>
<p>そのため、今回は欠損値の除去は行わずに進めます。（もし欠損値の除去を行う場合のコードは以下です。）</p>
<ul class="simple">
<li><p>行方向に除去する（サンプル数が減少）: df.dropna(subset=<code class="docutils literal notranslate"><span class="pre">欠損値を削除したいカラム名</span></code>)</p></li>
<li><p>列方向に除去する（カラム数が減少） : df.drop(<code class="docutils literal notranslate"><span class="pre">削除したいカラム名</span></code>, axis=1)</p></li>
</ul>
</section>
<section id="欠損値の補完">
<h3>欠損値の補完<a class="headerlink" href="#欠損値の補完" title="この見出しへのパーマリンク"></a></h3>
<p>次は欠損値補完について学びます。欠損値補完とは欠損値を他の値で埋める方法です。具体的には以下です。</p>
<ul class="simple">
<li><p>前方埋め（直前の時刻のデータで埋める）</p></li>
<li><p>後方埋め（直後の時刻のデータで埋める）</p></li>
</ul>
<p>その他、以下の統計量で埋める方法もあります。</p>
<ul class="simple">
<li><p>平均値</p></li>
<li><p>中央値</p></li>
<li><p>最頻値</p></li>
</ul>
<p>また、欠損値近傍の平均値や中央値で埋める移動平均（中央）値といった方法もあります。</p>
<p>それではまず 1 つの国のデータのみを取得し、欠損値補完を行ってみましょう。</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Canada のみ取得
canada = df[df[&#39;location&#39;]==&#39;Canada&#39;]
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># 欠損値の確認
canada.isnull().sum()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
iso_code                    0
continent                   0
location                    0
new_cases                   0
new_deaths                  0
total_cases_per_million     0
total_tests_per_thousand    3
population                  0
total_deaths_per_million    0
dtype: int64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>canada.tail()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>iso_code</th>
      <th>continent</th>
      <th>location</th>
      <th>new_cases</th>
      <th>new_deaths</th>
      <th>total_cases_per_million</th>
      <th>total_tests_per_thousand</th>
      <th>population</th>
      <th>total_deaths_per_million</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2022-01-14</th>
      <td>CAN</td>
      <td>North America</td>
      <td>Canada</td>
      <td>40306.0</td>
      <td>143.0</td>
      <td>71856.527</td>
      <td>1441.254</td>
      <td>38067913.0</td>
      <td>824.894</td>
    </tr>
    <tr>
      <th>2022-01-15</th>
      <td>CAN</td>
      <td>North America</td>
      <td>Canada</td>
      <td>15314.0</td>
      <td>119.0</td>
      <td>72258.808</td>
      <td>1443.619</td>
      <td>38067913.0</td>
      <td>828.020</td>
    </tr>
    <tr>
      <th>2022-01-16</th>
      <td>CAN</td>
      <td>North America</td>
      <td>Canada</td>
      <td>14926.0</td>
      <td>53.0</td>
      <td>72650.896</td>
      <td>NaN</td>
      <td>38067913.0</td>
      <td>829.412</td>
    </tr>
    <tr>
      <th>2022-01-17</th>
      <td>CAN</td>
      <td>North America</td>
      <td>Canada</td>
      <td>49644.0</td>
      <td>176.0</td>
      <td>73954.987</td>
      <td>NaN</td>
      <td>38067913.0</td>
      <td>834.036</td>
    </tr>
    <tr>
      <th>2022-01-18</th>
      <td>CAN</td>
      <td>North America</td>
      <td>Canada</td>
      <td>13832.0</td>
      <td>113.0</td>
      <td>74318.337</td>
      <td>NaN</td>
      <td>38067913.0</td>
      <td>837.004</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">total_tests_per_thousand</span></code> に欠損値があることがわかります。分布も確認しておきます。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plt.hist(canada[&#39;total_tests_per_thousand&#39;]);
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/src_01_01_00_python_basic_90_0.png" src="../_images/src_01_01_00_python_basic_90_0.png" />
</div>
</div>
<p>データのばらつきは小さいですが、少し左に偏りが見られる分布になっています。そのため今回は中央値で補完を検討してみます。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># 中央値を算出
canada[&#39;total_tests_per_thousand&#39;].median()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1278.425
</pre></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">total_tests_per_thousand</span></code> の中央値は 1278.425 でした。それまでの値と比較すると約 200 程違いがあることがわかります。そのため、今回は前方の値で埋めるようにしてみます。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># 前方埋め
canada = canada.fillna(method=&#39;ffill&#39;)
canada.tail()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>iso_code</th>
      <th>continent</th>
      <th>location</th>
      <th>new_cases</th>
      <th>new_deaths</th>
      <th>total_cases_per_million</th>
      <th>total_tests_per_thousand</th>
      <th>population</th>
      <th>total_deaths_per_million</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2022-01-14</th>
      <td>CAN</td>
      <td>North America</td>
      <td>Canada</td>
      <td>40306.0</td>
      <td>143.0</td>
      <td>71856.527</td>
      <td>1441.254</td>
      <td>38067913.0</td>
      <td>824.894</td>
    </tr>
    <tr>
      <th>2022-01-15</th>
      <td>CAN</td>
      <td>North America</td>
      <td>Canada</td>
      <td>15314.0</td>
      <td>119.0</td>
      <td>72258.808</td>
      <td>1443.619</td>
      <td>38067913.0</td>
      <td>828.020</td>
    </tr>
    <tr>
      <th>2022-01-16</th>
      <td>CAN</td>
      <td>North America</td>
      <td>Canada</td>
      <td>14926.0</td>
      <td>53.0</td>
      <td>72650.896</td>
      <td>1443.619</td>
      <td>38067913.0</td>
      <td>829.412</td>
    </tr>
    <tr>
      <th>2022-01-17</th>
      <td>CAN</td>
      <td>North America</td>
      <td>Canada</td>
      <td>49644.0</td>
      <td>176.0</td>
      <td>73954.987</td>
      <td>1443.619</td>
      <td>38067913.0</td>
      <td>834.036</td>
    </tr>
    <tr>
      <th>2022-01-18</th>
      <td>CAN</td>
      <td>North America</td>
      <td>Canada</td>
      <td>13832.0</td>
      <td>113.0</td>
      <td>74318.337</td>
      <td>1443.619</td>
      <td>38067913.0</td>
      <td>837.004</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>欠損値の補完ができていることが確認できました。その他の埋め方は以下を参照してください。</p>
<ul class="simple">
<li><p>平均値 : <code class="docutils literal notranslate"><span class="pre">fillna(df.mean())</span></code></p></li>
<li><p>中央値 : <code class="docutils literal notranslate"><span class="pre">fillna(df.median())</span></code></p></li>
<li><p>最頻値 : <code class="docutils literal notranslate"><span class="pre">fillna(df.mode[0])</span></code></p></li>
<li><p>前方埋め : <code class="docutils literal notranslate"><span class="pre">fillna(method='ffill')</span></code></p></li>
<li><p>後方埋め : <code class="docutils literal notranslate"><span class="pre">fillna(method='bfill')</span></code></p></li>
</ul>
<p>その他の国のデータに関しても欠損値補完を行ってみましょう。</p>
<p><em>※ 今回のデータでは国によって全て欠損となっている列も存在するため、その列の値はすべて 0 で補完するように処理しています。</em></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># 空のデータフレームを定義
df_2 = pd.DataFrame()
# すべての国毎に、前方埋めで欠損値を補完する
for co in df[&#39;location&#39;].value_counts().index:
    # 国毎にデータを取得
    country = df[df[&#39;location&#39;] == co]
    # 前方埋め
    country = country.fillna(method=&#39;ffill&#39;)
    # 前方埋めで対応できない箇所は 0 で埋める
    country = country.fillna(0)
    # DataFrame の結合
    df_2 = pd.concat([df_2, country], axis=0)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># 欠損値の数を確認する
df_2.isnull().sum()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
iso_code                    0
continent                   0
location                    0
new_cases                   0
new_deaths                  0
total_cases_per_million     0
total_tests_per_thousand    0
population                  0
total_deaths_per_million    0
dtype: int64
</pre></div></div>
</div>
<p>これで欠損値を全てなくすことができました。</p>
</section>
</section>
<section id="質的変数への対応">
<h2>質的変数への対応<a class="headerlink" href="#質的変数への対応" title="この見出しへのパーマリンク"></a></h2>
<p>文字列データを含めた、カテゴリを表すデータを質的変数といいます。（例えば「男性、女性」というような文字列データ。）既に数字に変換されていれば問題ありませんが、文字列のままの場合はモデルで扱うことができないため、一度数字に変換する必要があります。</p>
<p>数字に変換する方法は様々ありますが、今回は以下を紹介します。</p>
<ol class="arabic simple">
<li><p>Label Encoding (順序尺度に有効：順序に意味があるもの)</p></li>
<li><p>One Hot Encoding (名義尺度に有効：順序に意味がないもの)</p></li>
</ol>
<p>まずは今回のデータに質的変数があるかどうかを確認してみましょう。<code class="docutils literal notranslate"><span class="pre">df.select_dtypes(include='object')</span></code> で object 型（すなわち質的変数）の値を含むデータのみを取得できます。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># 質的変数を含んだデータのみを抽出
df_obj = df_2.select_dtypes(include=&#39;object&#39;)
df_obj.head(3)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>iso_code</th>
      <th>continent</th>
      <th>location</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-10-11</th>
      <td>ABW</td>
      <td>North America</td>
      <td>Aruba</td>
    </tr>
    <tr>
      <th>2021-10-12</th>
      <td>ABW</td>
      <td>North America</td>
      <td>Aruba</td>
    </tr>
    <tr>
      <th>2021-10-13</th>
      <td>ABW</td>
      <td>North America</td>
      <td>Aruba</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">unique()</span></code> メソッドで各列のユニークな値（具体的にどのカテゴリが含まれているか）を確認できます。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># ユニークな値の確認
df_obj[&#39;iso_code&#39;].unique()[:10] # 10 個だけ表示
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([&#39;ABW&#39;, &#39;OWID_NAM&#39;, &#39;NZL&#39;, &#39;OMN&#39;, &#39;OWID_AFR&#39;, &#39;OWID_ASI&#39;,
       &#39;OWID_CYN&#39;, &#39;OWID_EUN&#39;, &#39;OWID_EUR&#39;, &#39;OWID_HIC&#39;], dtype=object)
</pre></div></div>
</div>
<p>各列のユニークな値も確認しておきましょう。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>for uni in df_obj.columns:
    print(uni)
    print(df_obj[uni].unique()[:10])  # 10 個だけ表示
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
iso_code
[&#39;ABW&#39; &#39;OWID_NAM&#39; &#39;NZL&#39; &#39;OMN&#39; &#39;OWID_AFR&#39; &#39;OWID_ASI&#39; &#39;OWID_CYN&#39; &#39;OWID_EUN&#39;
 &#39;OWID_EUR&#39; &#39;OWID_HIC&#39;]
continent
[&#39;North America&#39; 0.0 &#39;Oceania&#39; &#39;Asia&#39; &#39;Europe&#39; &#39;South America&#39; &#39;Africa&#39;]
location
[&#39;Aruba&#39; &#39;North America&#39; &#39;New Zealand&#39; &#39;Oman&#39; &#39;Africa&#39; &#39;Asia&#39;
 &#39;Northern Cyprus&#39; &#39;European Union&#39; &#39;Europe&#39; &#39;High income&#39;]
</pre></div></div>
</div>
<p>それでは文字列から数値に変換を行ってみます。</p>
<section id="Label-Encoding">
<h3>Label Encoding<a class="headerlink" href="#Label-Encoding" title="この見出しへのパーマリンク"></a></h3>
<p>Label Encoding は各カテゴリに 0, 1, 2, … と数値を割り振る変換です。scikit learn の中の <code class="docutils literal notranslate"><span class="pre">preprocessing</span></code> モジュールにある <code class="docutils literal notranslate"><span class="pre">LabelEncodin()</span></code> クラスを使用します。</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># インスタンス化
from sklearn.preprocessing import LabelEncoder
le = LabelEncoder()
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># ラベルの設定
df_2[&#39;iso_code&#39;] = le.fit_transform(df_2[&#39;iso_code&#39;])
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>df_2.head(3)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>iso_code</th>
      <th>continent</th>
      <th>location</th>
      <th>new_cases</th>
      <th>new_deaths</th>
      <th>total_cases_per_million</th>
      <th>total_tests_per_thousand</th>
      <th>population</th>
      <th>total_deaths_per_million</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-10-11</th>
      <td>0</td>
      <td>North America</td>
      <td>Aruba</td>
      <td>19.0</td>
      <td>1.0</td>
      <td>145948.972</td>
      <td>0.0</td>
      <td>107195.0</td>
      <td>1585.895</td>
    </tr>
    <tr>
      <th>2021-10-12</th>
      <td>0</td>
      <td>North America</td>
      <td>Aruba</td>
      <td>18.0</td>
      <td>0.0</td>
      <td>146116.890</td>
      <td>0.0</td>
      <td>107195.0</td>
      <td>1585.895</td>
    </tr>
    <tr>
      <th>2021-10-13</th>
      <td>0</td>
      <td>North America</td>
      <td>Aruba</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>146116.890</td>
      <td>0.0</td>
      <td>107195.0</td>
      <td>1585.895</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">iso_code</span></code> の値が文字列から数字に変換されていることがわかります。それでは <code class="docutils literal notranslate"><span class="pre">location</span></code> についても Label Encoding を適用しましょう。</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># location にも適用
df_2[&#39;location&#39;] = le.fit_transform(df_2[&#39;location&#39;])
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>df_2.head(3)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>iso_code</th>
      <th>continent</th>
      <th>location</th>
      <th>new_cases</th>
      <th>new_deaths</th>
      <th>total_cases_per_million</th>
      <th>total_tests_per_thousand</th>
      <th>population</th>
      <th>total_deaths_per_million</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-10-11</th>
      <td>0</td>
      <td>North America</td>
      <td>10</td>
      <td>19.0</td>
      <td>1.0</td>
      <td>145948.972</td>
      <td>0.0</td>
      <td>107195.0</td>
      <td>1585.895</td>
    </tr>
    <tr>
      <th>2021-10-12</th>
      <td>0</td>
      <td>North America</td>
      <td>10</td>
      <td>18.0</td>
      <td>0.0</td>
      <td>146116.890</td>
      <td>0.0</td>
      <td>107195.0</td>
      <td>1585.895</td>
    </tr>
    <tr>
      <th>2021-10-13</th>
      <td>0</td>
      <td>North America</td>
      <td>10</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>146116.890</td>
      <td>0.0</td>
      <td>107195.0</td>
      <td>1585.895</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="One-Hot-Encoding">
<h3>One-Hot Encoding<a class="headerlink" href="#One-Hot-Encoding" title="この見出しへのパーマリンク"></a></h3>
<p>One - Hot Encoding はダミー変数化とも言われ、下記のように各カテゴリの値ごとに 0 1 の列を作成します。</p>
<p><strong>変換前</strong></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 100%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>gender</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>male</p></td>
</tr>
<tr class="row-odd"><td><p>female</p></td>
</tr>
<tr class="row-even"><td><p>none</p></td>
</tr>
</tbody>
</table>
<p><strong>変換後</strong></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 31%" />
<col style="width: 37%" />
<col style="width: 31%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>gender_male</p></th>
<th class="head"><p>gender_female</p></th>
<th class="head"><p>gender_none</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>0</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>0</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
<p>One - Hot Encoding は <code class="docutils literal notranslate"><span class="pre">pd.get_dummies()</span></code> で簡単に行うことができます。引数 <code class="docutils literal notranslate"><span class="pre">drop_first</span></code> では <code class="docutils literal notranslate"><span class="pre">True</span></code> / <code class="docutils literal notranslate"><span class="pre">False</span></code> を指定することができ、<code class="docutils literal notranslate"><span class="pre">True</span></code> にすることで変換後の先頭列を除去します。</p>
<p><strong>変換後（drop_first = True 適用時）</strong></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 54%" />
<col style="width: 46%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>gender_female</p></th>
<th class="head"><p>gender_none</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>0</p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
<p>先頭列を除去した形でも、gender_male を識別することは可能です。削除をしない場合は、作成されたダミー変数間の相関が強くなり、多重共線性といった学習の妨げになる問題が発生する可能性があるため注意しましょう。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># 変換前の shape
df_2.shape
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(23728, 9)
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># One Hot Encoding で変換
df_2 = pd.get_dummies(df_2, drop_first=True)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>df_2.head(3)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>iso_code</th>
      <th>location</th>
      <th>new_cases</th>
      <th>new_deaths</th>
      <th>total_cases_per_million</th>
      <th>total_tests_per_thousand</th>
      <th>population</th>
      <th>total_deaths_per_million</th>
      <th>continent_Africa</th>
      <th>continent_Asia</th>
      <th>continent_Europe</th>
      <th>continent_North America</th>
      <th>continent_Oceania</th>
      <th>continent_South America</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-10-11</th>
      <td>0</td>
      <td>10</td>
      <td>19.0</td>
      <td>1.0</td>
      <td>145948.972</td>
      <td>0.0</td>
      <td>107195.0</td>
      <td>1585.895</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2021-10-12</th>
      <td>0</td>
      <td>10</td>
      <td>18.0</td>
      <td>0.0</td>
      <td>146116.890</td>
      <td>0.0</td>
      <td>107195.0</td>
      <td>1585.895</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2021-10-13</th>
      <td>0</td>
      <td>10</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>146116.890</td>
      <td>0.0</td>
      <td>107195.0</td>
      <td>1585.895</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># 変換後の shape
df_2.shape
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(23728, 14)
</pre></div></div>
</div>
<p>文字列データが数値（ダミー変数）に置き換わっていることが確認できます。変換前は入力変数の数が 9 でしたが、14 に増えています。このように <strong>入力変数の数が増える点がOne-Hot Encodingのデメリット</strong> になります。</p>
<p>カテゴリの数が非常に多いような場合には、グルーピングしてカテゴリ数を減らしたりするとよいでしょう。</p>
</section>
</section>
<section id="【補足】Python-補足資料">
<h2>【補足】Python 補足資料<a class="headerlink" href="#【補足】Python-補足資料" title="この見出しへのパーマリンク"></a></h2>
<section id="Python">
<h3>Python<a class="headerlink" href="#Python" title="この見出しへのパーマリンク"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.kikagaku.co.jp/python/">https://docs.kikagaku.co.jp/python/</a></p></li>
<li><p>ユーザー名：kikagaku</p></li>
<li><p>パスワード：python</p></li>
</ul>
</section>
<section id="NumPy">
<h3>NumPy<a class="headerlink" href="#NumPy" title="この見出しへのパーマリンク"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.kikagaku.co.jp/numpy/">https://docs.kikagaku.co.jp/numpy/</a></p></li>
<li><p>ユーザー名：kikagaku</p></li>
<li><p>パスワード：numpy</p></li>
</ul>
</section>
<section id="Pandas">
<h3>Pandas<a class="headerlink" href="#Pandas" title="この見出しへのパーマリンク"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.kikagaku.co.jp/pandas/">https://docs.kikagaku.co.jp/pandas/</a></p></li>
<li><p>ユーザー名：kikagaku</p></li>
<li><p>パスワード：pandas</p></li>
</ul>
</section>
<section id="Matplotlib-/-seaborn">
<h3>Matplotlib / seaborn<a class="headerlink" href="#Matplotlib-/-seaborn" title="この見出しへのパーマリンク"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.kikagaku.co.jp/matplotlib/">https://docs.kikagaku.co.jp/matplotlib/</a></p></li>
<li><p>ユーザー名：kikagaku</p></li>
<li><p>パスワード：matplotlib</p></li>
</ul>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="01_01_00_data.html" class="btn btn-neutral float-left" title="データの理解" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="01_01_01_question.html" class="btn btn-neutral float-right" title="演習問題" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, kikagaku.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>